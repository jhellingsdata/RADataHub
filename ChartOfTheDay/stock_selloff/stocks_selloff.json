{
    "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
    "data": {
        "url": "https://raw.githubusercontent.com/jhellingsdata/RADataHub/refs/heads/main/ChartOfTheDay/stock_selloff/closes.csv"
    },
    "transform": [
    {"filter": "datum.Indexed_Close != 0"}
  ],
  "height": 400,
  "width": 600,
  "encoding": {
    "x": {
      "field": "Date",
      "type": "temporal", 
      "axis": {"grid": false},
      "title":null
      },
    "y": {
      "field": "Indexed_Close", 
      "type": "quantitative",
      "scale": {"zero": false},
      "title": "Stocks Index (Trump Inauguration = 100)"
    },
    "color": {
      "field": "Index",
      "type": "nominal",
      "scale": {
        "domain": ["US", "UK", "Germany", "China", "Canada", "Japan"]
      },
      "legend": null
    },
    "opacity": {
      "condition": {
        "param": "hover",
        "value": 1
      },
      "value": 0.7
    }
  },
  "layer": [
    {
      "params": [{
        "name": "hover",
        "select": {
          "type": "point",
          "fields": ["Index"],
          "on": "pointerover"
        }
      }],
      "mark": {"type": "line", "strokeWidth": 6, "stroke": "transparent"}
    },
    {
      "mark": {"type": "line", "strokeWidth": 2}
    },
    {
      "transform": [
        {
          "window": [{"op": "rank", "as": "ranking"}],
          "sort": [{"field": "Date", "order": "descending"}],
          "groupby": ["Index"]
        },
        {"filter": "datum.ranking === 1"}
      ],
      "layer": [
        {
          "mark": {"type": "circle", "size": 80}
        },
        {
          "mark": {"type": "text", "align": "left", "dx": 8},
          "encoding": {"text": {"field": "Index", "type": "nominal"}}
        }
      ]
    }
  ],
    "config": {
        "font": "Circular Std",
        "view": {
            "stroke": "transparent"
        },
        "range": {
            "category": [
                "#36B7B4",
                "#E6224B",
                "#F4C245",
                "#0063AF",
                "#00A767",
                "#179FDB",
                "#EB5C2E"
            ],
            "diverging": [
                "#E6224B",
                "#E54753",
                "#C9C9C9",
                "#179FDB",
                "#122B39"
            ],
            "heatmap": [
                "#C9C9C9",
                "#179FDB",
                "#0063AF",
                "#122B39"
            ],
            "ordinal": [
                "#00A767",
                "#36B7B4",
                "#179FDB",
                "#0063AF",
                "#243B5A"
            ]
        },
        "axisX": {
            "domainColor": "#676A86",
            "domainOpacity": 0.5,
            "grid": false,
            "labelAngle": 0,
            "labelColor": "#676A86",
            "labelOpacity": 0.7,
            "orient": "bottom",
            "tickColor": "#676A86",
            "tickCount": 10,
            "tickOpacity": 0.5,
            "labelFontSize": 13,
            "titleAlign": "center",
            "titleAnchor": "middle",
            "titleColor": "#676A86",
            "titleFontSize": 12,
            "titleOpacity": 0.8,
            "titleY": -15
        },
        "axisY": {
            "domainColor": "#676A86",
            "domainOpacity": 0.5,
            "gridColor": "#676A86",
            "gridDash": [
                1,
                5
            ],
            "gridOpacity": 0.5,
            "labelColor": "#676A86",
            "labelOpacity": 0.7,
            "labelPadding": 5,
            "labelFontSize": 13,
            "tickColor": "#676A86",
            "tickCount": 8,
            "tickOpacity": 0.5,
            "ticks": false,
            "titleAlign": "left",
            "titleAngle": 0,
            "titleBaseline": "bottom",
            "titleColor": "#676A86",
            "titleFontSize": 12,
            "titleOpacity": 0.8,
            "titleX": 0,
            "titleY": -7
        }
    }
}